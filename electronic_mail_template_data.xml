<?xml version="1.0"?>
<!-- This file is part pyme module for Tryton.
The COPYRIGHT file at the top level of this repository contains the full copyright notices and license terms. -->
<tryton>
    <data noupdate="1" skiptest="1">
        <!-- TODO: Delete this record -->
        <record model="smtp.server" id="smtp_demo_server">
            <field name="name">Demo Server</field>
            <field name="smtp_server">smtp.demo_server.com</field>
            <field name="smtp_port">587</field>
            <field name="smtp_ssl" eval="False"/>
            <field name="smtp_tls" eval="True"/>
            <field name="smtp_user">user@demo_server.com</field>
            <field name="smtp_password">Secret_Password</field>
            <field name="smtp_email">user@demo_server.com</field>
            <field name="state">done</field>
        </record>

        <record model="electronic.mail.template" id="party_email_template">
            <field name="name">Party eMail</field>
            <field name="from_">user@demo_server.com</field>
            <field name="to">${','.join([x.email for x in record.addresses if x.email]) or record.get_mechanism('email') or ''}</field>
            <field name="subject">${record.name}</field>
            <field name="smtp_server" ref="smtp_demo_server"/>
            <field name="model" search="[('model', '=', 'party.party')]"/>
            <field name="language">${record.lang and record.lang.code or 'es_ES'}</field>
            <field name="plain">${record.name}

Estimado Sr./Sra.

Atentamente,</field>
            <field name="html">&lt;h2&gt;${record.name}&lt;/h2&gt;

&lt;p&gt;Estimado Sr./Sra.&lt;/p&gt;

&lt;p&gt;Atentamente,&lt;/p&gt;</field>
            <field name="engine">genshi</field>
            <field name="signature" eval="True"/>
        </record>

        <record model="electronic.mail.template" id="contact_email_template">
            <field name="name">Contact eMail</field>
            <field name="from_">user@demo_server.com</field>
            <field name="to">${record.email or record.party.get_mechanism('email') or ''}</field>
            <field name="subject">Subject ${record.name}</field>
            <field name="smtp_server" ref="smtp_demo_server"/>
            <field name="model" search="[('model', '=', 'party.address')]"/>
            <field name="language">${record.party.lang and record.party.lang.code or 'es_ES'}</field>
            <field name="plain">${record.name}

Estimado Sr./Sra.

Atentamente,</field>
            <field name="html">&lt;h2&gt;${record.name}&lt;/h2&gt;

&lt;p&gt;Estimado Sr./Sra.&lt;/p&gt;

&lt;p&gt;Atentamente,&lt;/p&gt;</field>
            <field name="engine">genshi</field>
            <field name="signature" eval="True"/>
        </record>

        <record model="electronic.mail.template" id="sale_email_template">
            <field name="name">Sale eMail</field>
            <field name="from_">user@demo_server.com</field>
            <field name="to">${record.party.email or record.party.get_mechanism('email') or ''}</field>
            <field name="subject">${record.shipment_address.name} / ${record.reference or record.party.name} / ${record.create_date}</field>
            <field name="smtp_server" ref="smtp_demo_server"/>
            <field name="model" search="[('model', '=', 'sale.sale')]"/>
            <field name="language">${record.party.lang and record.party.lang.code or 'es_ES'}</field>
            <field name="plain">Estimado Sr./Sra.

${record.invoice_address and record.invoice_address.name or ''}

#if record.state == 'quotation'
Adjuntamos al presente correo electrónico el presupuesto ${record.description or ''} con referéncia ${record.reference}
#end
#if record.state == 'draft'
Adjuntamos al presente correo electrónico el pedido de venta solicitado.
#end
#if record.state != 'draft'
Adjuntamos al presente correo electrónico el pedido de venta con fecha ${str(record.sale_date)[8:]}-${str(record.sale_date)[5:7]}-${str(record.sale_date)[:4]} y número ${record.reference}
#end

#if record.lines
  Ctd Producto
  #for line in record.lines
  ${line.quantity} ${line.description} 
  #end
#end


Atentamente,</field>
            <field name="html">&lt;html&gt;
&lt;head&gt;
    &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;
    &lt;title&gt;
#if record.state == 'draft'
Presupuesto ${record.description or ''}
#end
#if record.state == 'quotation'
Presupuesto ${record.description or ''} con referencia ${record.reference}
#end
#if record.state not in ['draft', 'quotation']
Pedido de venta '${record.description or ''}
#end
    &lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;table cellspacing="0" cellpadding="0" border="0" width="100%"&gt;
        &lt;tr&gt;
            &lt;td bgcolor="#FFFFFF" align="center"&gt;
                &lt;table width="650px" cellspacing="0" cellpadding="3" class="container"&gt;
                    &lt;tr&gt;&lt;td&gt;
&lt;p&gt;Estimado Sr./Sra. ${record.invoice_address.name or ''},&lt;/p&gt;

#if record.state == 'draft'
&lt;p&gt;Adjuntamos el presupuesto ${record.description or ''} que ha solicitado.&lt;/p&gt;
#end
#if record.state == 'quotation'
&lt;p&gt;Adjuntamos el presupuesto ${record.description or ''} con referencia ${record.reference}.&lt;/p&gt;
#end
#if record.state not in ['draft', 'quotation']
&lt;p&gt;Adjuntamos el pedido de venta ${record.description or ''} con fecha ${str(record.sale_date)[8:]}-${str(record.sale_date)[5:7]}-${str(record.sale_date)[:4]} y referència ${record.reference}.&lt;/p&gt;
#end
                    &lt;/td&gt;&lt;/tr&gt;
                    &lt;tr&gt;
                        &lt;td&gt;
                        &lt;table class="table table-condensed" width="647"&gt;
                        &lt;thead&gt;
                            &lt;tr&gt;
                            &lt;th&gt;Cantidad&lt;/th&gt;
                            &lt;th&gt;Producto&lt;/th&gt;
                            &lt;th&gt;Precio&lt;/th&gt;
                            &lt;th&gt;Total&lt;/th&gt;
                            &lt;/tr&gt;
                        &lt;/thead&gt;
                        &lt;tbody&gt;
#for line in record.lines
#if line.type == 'line'
                        &lt;tr&gt;&lt;td&gt;${line.quantity or ''}&lt;/td&gt;&lt;td&gt;${line.product and line.product.rec_name}&lt;/td&gt;&lt;td style="text-align: right; color:#006699;"&gt;${round(line.unit_price, 2) or ''}&lt;/td&gt;&lt;td style="text-align: right; color:#006699;"&gt;${line.amount or ''}&lt;/td&gt;&lt;/tr&gt;
#end
#end
                        &lt;tr&gt;
                            &lt;td colspan="4" style="text-align: right; color:#006699;"&gt;
                                &lt;hr/&gt;
                                &lt;ul style="list-style: none";&gt;
                                    &lt;li&gt;&lt;strong&gt;Base:&lt;/strong&gt; ${record.untaxed_amount}&lt;/li&gt;
                                    &lt;li&gt;&lt;strong&gt;Impuestos:&lt;/strong&gt; ${record.tax_amount}&lt;/li&gt;
                                    &lt;li&gt;&lt;strong&gt;Total:&lt;/strong&gt; ${record.total_amount}&lt;/li&gt;
                                &lt;/ul&gt;
                            &lt;/td&gt;
                        &lt;/tr&gt;
                        &lt;/tbody&gt;
                        &lt;/table&gt;
                        &lt;/td&gt;
                    &lt;/tr&gt;
                &lt;/table&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td bgcolor="#FFFFFF" align="center"&gt;
                &lt;table width="650px" cellspacing="0" cellpadding="3" class="container"&gt;
                    &lt;tr&gt;
                        &lt;td&gt;
                            &lt;hr&gt;
                            &lt;p&gt;${record.company.party.get_mechanism('email') or ''}&lt;/p&gt;
                        &lt;/td&gt;
                    &lt;/tr&gt;
                &lt;/table&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
    &lt;/table&gt;
&lt;/body&gt;
&lt;/html&gt;</field>
            <field name="engine">genshi</field>
            <field name="signature" eval="True"/>
        </record>

        <record model="electronic.mail.template" id="invoice_email_template">
            <field name="name">Invoice eMail</field>
            <field name="from_">user@demo_server.com</field>
            <field name="to">${record.party.get_mechanism('email') or ''}</field>
            <field name="subject">Factura ${record.number or record.party.name} / ${record.invoice_address.name} </field>
            <field name="smtp_server" ref="smtp_demo_server"/>
            <field name="model" search="[('model', '=', 'account.invoice')]"/>
            <field name="language">${record.party.lang and record.party.lang.code or 'es_ES'}</field>
            <field name="plain">Para cualquier aclaración, contacte con ${record.company.party.get_mechanism('email') or 'user@demo_server.com'}

Atentamente,
${record.party.name}</field>
            <field name="html">&lt;p&gt;Para cualquier aclaración, contacte con ${record.company.party.get_mechanism('email') or 'user@demo_server.com'}&lt;/p&gt;

&lt;p&gt;Atentamente&lt;/p&gt;
&lt;p&gt;${record.party.name}&lt;/p&gt;</field>
            <field name="engine">genshi</field>
            <field name="signature" eval="True"/>
        </record>
    </data>
</tryton>
